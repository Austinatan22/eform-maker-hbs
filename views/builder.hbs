{{!-- Uses layouts/main.hbs by default --}}

<div class="row g-3">
  <!-- Left column -->
  <div class="col-12 col-lg-4 sticky-lg-top align-self-start">
    <div class="card">
      <div class="card-header">
        <div class="nav-align-top">
          <ul class="nav nav-pills nav-fill" role="tablist">
            <li class="nav-item">
              <button id="tabAdd" type="button" class="nav-link active"
                      role="tab" data-bs-toggle="tab" data-bs-target="#lp-pill-add"
                      aria-controls="lp-pill-add" aria-selected="true">
                Add Fields
              </button>
            </li>
            <li class="nav-item">
              <button id="tabEdit" type="button" class="nav-link"
                      role="tab" data-bs-toggle="tab" data-bs-target="#lp-pill-edit"
                      aria-controls="lp-pill-edit" aria-selected="false">
                Edit Field
              </button>
            </li>
          </ul>
        </div>
      </div>

      <div class="card-body tab-content">
        <!-- Add Fields -->
        <div class="tab-pane fade show active" id="lp-pill-add" role="tabpanel" aria-labelledby="tabAdd">
          <div class="mb-3">
            <label class="form-label">Add Fields</label>
            <div id="quickAddButtons" class="row g-2 align-items-stretch">
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="singleLine"><i class="icon-base ti tabler-forms icon-sm me-2"></i><span class="text-start">Single Line</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="paragraph"><i class="icon-base ti tabler-article icon-sm me-2"></i><span class="text-start">Paragraph</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="dropdown"><i class="icon-base ti tabler-list icon-sm me-2"></i><span class="text-start">Dropdown</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="multipleChoice"><i class="icon-base ti tabler-list-check icon-sm me-2"></i><span class="text-start">Multi-choice</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="checkboxes"><i class="icon-base ti tabler-square-rounded-check icon-sm me-2"></i><span class="text-start">Checkboxes</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="number"><i class="icon-base ti tabler-list-numbers icon-sm me-2"></i><span class="text-start">Number</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="name"><i class="icon-base ti tabler-user icon-sm me-2"></i><span class="text-start">Name</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="email"><i class="icon-base ti tabler-mail icon-sm me-2"></i><span class="text-start">Email</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="phone"><i class="icon-base ti tabler-phone icon-sm me-2"></i><span class="text-start">Phone</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="multipleChoice" data-label="Yes / No" data-options="Yes,No"><i class="icon-base ti tabler-list-check icon-sm me-2"></i><span class="text-start">Yes/No</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="multipleChoice" data-label="NPS (1-10)" data-options="1,2,3,4,5,6,7,8,9,10"><i class="icon-base ti tabler-chart-pie icon-sm me-2"></i><span class="text-start">NPS (1-10)</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="dropdown" data-label="Issue Type" data-options="Billing,Bug,Feature Request,Other"><i class="icon-base ti tabler-list-details icon-sm me-2"></i><span class="text-start">Issue Type</span></button></div>
              <div class="col-6 d-flex"><button type="button" class="btn btn-outline-primary w-100 h-100 d-flex justify-content-start align-items-start text-start" data-type="checkboxes" data-label="Consent" data-options="I agree to the terms"><i class="icon-base ti tabler-square-rounded-check icon-sm me-2"></i><span class="text-start">Consent</span></button></div>
            </div>
          </div>
        </div>

        <!-- Edit Field -->
        <div class="tab-pane fade" id="lp-pill-edit" role="tabpanel" aria-labelledby="tabEdit">
          <h5 id="editTitle" class="text-body-secondary">No field selected</h5>

          <div class="mb-3">
            <label for="editLabel" class="form-label">Display Label</label>
            <span class="text-danger">*</span>
            <input id="editLabel" type="text" class="form-control" placeholder="Shown to users">
          </div>

          <div class="mb-3" id="editOptionsRow">
            <label for="editOptions" class="form-label">Options (comma-separated)</label>
            <span class="text-danger">*</span>
            <input id="editOptions" type="text" class="form-control" placeholder="Option 1, Option 2">
          </div>

          <div class="mb-3">
            <label for="editValue" class="form-label">Default Value</label>
            <input id="editValue" type="text" class="form-control" placeholder="(optional)">
          </div>

          <div class="mb-3">
            <label for="editPlaceholder" class="form-label">Placeholder</label>
            <input id="editPlaceholder" type="text" class="form-control" placeholder="(optional)">
          </div>

          <div class="mb-3">
            <label for="editName" class="form-label">Field Name (internal)</label>
            <span class="text-danger">*</span>
            <input id="editName" type="text" class="form-control" placeholder="camelCase">
          </div>

          <div class="mb-3">
            <div class="form-check">
              <input id="editRequired" class="form-check-input" type="checkbox">
              <label class="form-check-label" for="editRequired">Required</label>
            </div>
          </div>
          <div class="mb-3">
            <div class="form-check">
              <input id="editDoNotStore" class="form-check-input" type="checkbox">
              <label class="form-check-label" for="editDoNotStore">Do not store this field</label>
            </div>
          </div>

          <button id="editCancel" class="btn btn-danger waves-effect waves-light w-100">
            Delete Field
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Right column (Preview) -->
  <div class="col-12 col-lg-8">
    <div class="card">
      <div class="card-header sticky-lg-top bg-label-secondary d-flex justify-content-sm-between align-items-sm-center flex-column flex-sm-row z-2 border-bottom">
        <h5 class="card-title mb-sm-0 me-sm-2">Preview</h5>
        <div class="action-btns d-flex align-items-start w-100 w-sm-auto gap-2">
          <input id="formTitle" type="text" class="form-control form-control" value="{{form.title}}" placeholder="Form Title" />
          <button id="saveBtn" class="btn btn-success">Save</button>
        </div>
      </div>
      <div class="card-body pt-4">
        <div id="preview"></div>
      </div>
    </div>
  </div>
</div>

{{#section 'scripts'}}
  {{#if preloadJson}}
  <script>
    try {
      // Insert raw JSON into JS as an object literal, then stringify safely
      localStorage.setItem('eform-maker-hbs', JSON.stringify({{{preloadJson}}}));
    } catch (e) {}
  </script>
  {{/if}}

  <!-- Provide utils URL like the client page -->
  <script>
    window.INTL_UTILS_URL = "https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/utils.js";
    // Enable modular Builder boot
    window.BUILDER_USE_MODULAR = true;
  </script>

  <!-- SortableJS for robust drag-and-drop reordering -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>

  <script src="/js/builder.js"></script>
{{/section}}

